% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/collinearity_diagnostics.R
\name{extract_l1_collinearity}
\alias{extract_l1_collinearity}
\title{Extract collinearity diagnostics from all L1 models}
\usage{
extract_l1_collinearity(
  gpa,
  l1_model_names = NULL,
  vif_threshold = 5,
  cor_threshold = 0.8
)
}
\arguments{
\item{gpa}{A glm_pipeline_arguments object that has been processed through setup_l1_models}

\item{l1_model_names}{Character vector of L1 model names to extract. If NULL (default),
extracts from all available models.}

\item{vif_threshold}{Numeric threshold for flagging high VIF values. Default is 5.}

\item{cor_threshold}{Numeric threshold for flagging high correlations. Default is 0.8.}
}
\value{
A list with class "l1_collinearity_summary" containing:
\itemize{
  \item \code{vif_summary}: A data.frame with VIF values for each regressor, subject, session, run, and model.
    Includes a flag for VIFs exceeding the threshold.
  \item \code{correlation_summary}: A data.frame with pairwise correlations between regressors
    for each subject, session, run, and model. Includes a flag for correlations exceeding the threshold.
  \item \code{high_vif}: A data.frame subset of vif_summary where VIF exceeds the threshold.
  \item \code{high_correlation}: A data.frame subset of correlation_summary where |r| exceeds the threshold.
  \item \code{summary_stats}: Aggregate statistics across all subjects/runs.
  \item \code{thresholds}: The VIF and correlation thresholds used.
}
}
\description{
This function reads the saved build_design_matrix objects (d_obj) from all subjects
and models, extracting collinearity diagnostics (correlations and VIFs) into a
structured format suitable for review and quality control.
}
\details{
This function iterates through all subject/model combinations in the gpa object,
loading the cached design matrix objects and extracting collinearity information.
The resulting summaries can be used to identify problematic regressors or runs
that may have estimation issues due to multicollinearity.

Common causes of high collinearity include:
\itemize{
  \item Parametric regressors that are highly correlated with task indicator regressors
  \item Events that occur too close together in time
  \item Insufficient variation in parametric modulators within a run
}
}
\examples{
\dontrun{
  # After running setup_l1_models
  collin_summary <- extract_l1_collinearity(gpa)
  
  # View high VIF regressors
  print(collin_summary$high_vif)
  
  # View highly correlated regressor pairs
  print(collin_summary$high_correlation)
  
  # Get overall summary
  print(collin_summary)
}

}
